---
sidebar_position: 4
title: 4. Caminhada e NavegaÃ§Ã£o
description: TÃ©cnicas de locomoÃ§Ã£o
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# ğŸš¶ Caminhada e NavegaÃ§Ã£o

:::tip Objetivo
Dominar as tÃ©cnicas de locomoÃ§Ã£o bÃ­pede do Unitree G1, incluindo modos de caminhada, navegaÃ§Ã£o autÃ´noma e controle de equilÃ­brio.
:::

---

## ğŸ¯ Fundamentos da LocomoÃ§Ã£o BÃ­pede

O Unitree G1 utiliza **locomoÃ§Ã£o bÃ­pede dinÃ¢mica**, diferente de robÃ´s com rodas ou esteiras. Isso requer controle preciso de 12 motores nas pernas para manter equilÃ­brio.

### DiferenÃ§a entre LocomoÃ§Ã£o EstÃ¡tica vs DinÃ¢mica

```
LOCOMOÃ‡ÃƒO ESTÃTICA (robÃ´s antigos):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Centro de massa sempre dentro da base de suporte
â€¢ Muito lento (< 0.5 m/s)
â€¢ Sem quedas, mas sem agilidade

LOCOMOÃ‡ÃƒO DINÃ‚MICA (G1):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ Centro de massa pode sair da base temporariamente
â€¢ RÃ¡pido (atÃ© 2 m/s)
â€¢ Usa momento e inÃ©rcia para eficiÃªncia
â€¢ Requer controle avanÃ§ado (IMU + encoders)
```

---

## ğŸš€ Modos de Caminhada

O G1 possui **4 modos de caminhada** otimizados para diferentes cenÃ¡rios:

<Tabs>
<TabItem value="walk" label="Walk (PadrÃ£o)">

### ğŸš¶ Walk Mode - Caminhada Normal

**Velocidade:** 0.2 - 1.0 m/s
**Energia:** Baixo consumo
**Uso:** Ambientes internos, proximidade de pessoas

```python
# Via App mÃ³vel:
g1_controller.set_gait_mode("walk")
g1_controller.set_velocity(linear_x=0.5, angular_z=0.0)

# Via ROS2 (programaÃ§Ã£o):
ros2 topic pub /cmd_vel geometry_msgs/Twist \
  '{linear: {x: 0.5, y: 0.0, z: 0.0}, angular: {x: 0.0, y: 0.0, z: 0.0}}'
```

**CaracterÃ­sticas:**
- âœ… Muito estÃ¡vel
- âœ… Silencioso
- âœ… Suave para segurar objetos
- âŒ Lento para longas distÃ¢ncias

</TabItem>

<TabItem value="trot" label="Trot (RÃ¡pido)">

### ğŸƒ Trot Mode - Trote RÃ¡pido

**Velocidade:** 1.0 - 2.0 m/s
**Energia:** MÃ©dio consumo
**Uso:** NavegaÃ§Ã£o rÃ¡pida em espaÃ§os abertos

```python
g1_controller.set_gait_mode("trot")
g1_controller.set_velocity(linear_x=1.5, angular_z=0.0)
```

**CaracterÃ­sticas:**
- âœ… 3x mais rÃ¡pido que walk
- âœ… Eficiente energeticamente
- âš ï¸ Mais barulho
- âŒ Menos estÃ¡vel para manipulaÃ§Ã£o

**TransiÃ§Ã£o segura:**
```python
# ERRADO: MudanÃ§a abrupta causa queda
g1.set_gait_mode("trot")  # âŒ

# CERTO: Acelerar gradualmente
g1.set_gait_mode("walk")
g1.set_velocity(0.5)
time.sleep(2)
g1.set_gait_mode("trot")
g1.ramp_velocity(0.5, 1.5, duration=3)  # âœ…
```

</TabItem>

<TabItem value="climb" label="Climb (Escadas)">

### ğŸªœ Climb Mode - Subir Escadas

**Altura mÃ¡xima do degrau:** 18 cm
**Ã‚ngulo mÃ¡ximo:** 35Â°
**Energia:** Alto consumo

```python
# Detecta escada automaticamente (sensores LIDAR)
g1_controller.enable_auto_climb(True)

# Ou manualmente:
g1_controller.set_gait_mode("climb")
g1_controller.climb_stairs(
    step_height=0.15,  # metros
    num_steps=10
)
```

**SeguranÃ§a:**
```python
# Antes de subir, verificar sensores
if g1.get_stair_detection_confidence() > 0.85:
    g1.climb_stairs(...)
else:
    print("âš ï¸ Escada nÃ£o detectada claramente!")
```

</TabItem>

<TabItem value="balance" label="Balance (EquilÃ­brio)">

### âš–ï¸ Balance Mode - EquilÃ­brio Parado

**Uso:** Ficar parado sem gastar energia
**Energia:** MÃ­nimo

```python
# Parar e manter equilÃ­brio
g1_controller.set_gait_mode("balance")
g1_controller.set_velocity(0, 0)

# Resistir a empurrÃµes (compliance control)
g1_controller.set_compliance(
    stiffness=50,  # 0-100, quanto maior mais rÃ­gido
    damping=20
)
```

**Teste de estabilidade:**
```python
# Aplicar forÃ§a externa (empurrar levemente)
# G1 deve auto-corrigir em < 0.5 segundos
for i in range(10):
    force = random.uniform(-20, 20)  # Newtons
    g1.apply_external_force(force, duration=0.2)
    time.sleep(1)
```

</TabItem>
</Tabs>

---

## ğŸ—ºï¸ NavegaÃ§Ã£o AutÃ´noma

### Sistema de NavegaÃ§Ã£o

O G1 usa **Nav2** (ROS2 Navigation Stack) para navegaÃ§Ã£o autÃ´noma:

```
PIPELINE DE NAVEGAÃ‡ÃƒO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. Mapping (SLAM)
   â””â”€> Criar mapa 2D do ambiente

2. Localization (AMCL)
   â””â”€> "Onde estou no mapa?"

3. Path Planning (NavFn/Smac)
   â””â”€> "Qual melhor caminho?"

4. Local Planner (DWB)
   â””â”€> "Como evitar obstÃ¡culos dinamicamente?"

5. Recovery Behaviors
   â””â”€> "Se ficar preso, como sair?"
```

### Criar Mapa do Ambiente

<Tabs>
<TabItem value="app" label="Via App">

**MÃ©todo visual (mais fÃ¡cil):**

1. Abrir app Unitree â†’ **"Mapping"**
2. Colocar G1 em ponto inicial
3. Pressionar **"Start Mapping"**
4. Controlar G1 manualmente para ele percorrer todos os cÃ´modos
5. Pressionar **"Save Map"** â†’ Nomear (ex: "casa_andar1")

**Dica:** Caminhe devagar (~0.3 m/s) e passe por todos os cantos!

</TabItem>

<TabItem value="ros2" label="Via ROS2">

**MÃ©todo programÃ¡tico:**

```bash
# 1. Iniciar SLAM Toolbox
ros2 launch slam_toolbox online_async_launch.py

# 2. Visualizar mapa sendo criado
rviz2 -d $(ros2 pkg prefix unitree_nav)/config/slam.rviz

# 3. Controlar G1 para mapear
ros2 run teleop_twist_keyboard teleop_twist_keyboard

# 4. Salvar mapa quando completo
ros2 run nav2_map_server map_saver_cli -f ~/maps/my_house
```

**ParÃ¢metros importantes:**
```yaml
# slam_params.yaml
map_update_interval: 5.0  # Atualizar mapa a cada 5s
resolution: 0.05           # 5cm por pixel
range_min: 0.15           # Ignorar objetos < 15cm
range_max: 12.0           # Escanear atÃ© 12 metros
```

</TabItem>
</Tabs>

### NavegaÃ§Ã£o para Ponto EspecÃ­fico

```python
from unitree_sdk import G1Navigator

nav = G1Navigator()

# Carregar mapa
nav.load_map("casa_andar1")

# Setar pose inicial (onde G1 estÃ¡ agora)
nav.set_initial_pose(x=0.0, y=0.0, theta=0.0)

# Navegar para coordenada
nav.navigate_to_pose(x=5.0, y=2.0, theta=1.57)  # 1.57 rad = 90Â°

# Aguardar chegada
while not nav.is_goal_reached():
    print(f"DistÃ¢ncia restante: {nav.get_distance_to_goal():.2f}m")
    time.sleep(0.5)

print("âœ… Chegou ao destino!")
```

### NavegaÃ§Ã£o SemÃ¢ntica (Locais Nomeados)

```python
# Salvar locais importantes
nav.save_location("cozinha", x=5.0, y=2.0, theta=0.0)
nav.save_location("sala", x=1.0, y=-1.5, theta=3.14)
nav.save_location("quarto", x=8.0, y=4.0, theta=1.57)

# Navegar por nome
nav.go_to("cozinha")  # Muito mais fÃ¡cil! âœ…
```

---

## âš ï¸ DetecÃ§Ã£o e Desvio de ObstÃ¡culos

### Hierarquia de Sensores

```
PRIORIDADE DE SENSORES (do mais ao menos prioritÃ¡rio):
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. LIDAR 3D (peito)      â†’ ObstÃ¡culos 0.2m - 10m
2. Depth Camera (cabeÃ§a) â†’ ObstÃ¡culos pequenos
3. IMU (torso)           â†’ Detectar quedas iminentes
4. Foot Force Sensors    â†’ Terreno irregular
```

### Configurar Zonas de SeguranÃ§a

```python
# Zona de parada imediata
nav.set_safety_zone(
    emergency_stop_distance=0.3,  # Parar se obstÃ¡culo < 30cm
    slow_down_distance=1.0,       # Reduzir velocidade se < 1m
    costmap_inflation=0.5         # "Inflar" obstÃ¡culos 50cm
)

# Exemplo de uso:
nav.navigate_to_pose(x=5.0, y=2.0)

# Se pessoa aparecer < 30cm:
# â†’ G1 para IMEDIATAMENTE âœ…
```

### Comportamentos de Recovery

Se G1 ficar preso (ex: canto de parede), ele tenta:

```python
recovery_behaviors = [
    "back_up",        # 1. Andar para trÃ¡s 50cm
    "spin_in_place",  # 2. Girar 360Â° buscando saÃ­da
    "clear_costmap",  # 3. Resetar mapa de obstÃ¡culos
    "wait",           # 4. Aguardar 10s (obstÃ¡culo pode se mover)
]

nav.set_recovery_behaviors(recovery_behaviors)
```

---

## ğŸ® Controle Manual AvanÃ§ado

### Velocidade Diferenciada (Curved Walking)

```python
# Andar em curva
g1.set_velocity(
    linear_x=0.5,   # 0.5 m/s para frente
    angular_z=0.3   # Girar 0.3 rad/s para esquerda
)

# Resultado: G1 anda em arco! ğŸŒ€
```

### Modos de Controle

<Tabs>
<TabItem value="velocity" label="Velocity Control">

**Controle por velocidade** (padrÃ£o):

```python
# VocÃª especifica velocidade, G1 controla posiÃ§Ã£o
g1.set_velocity_mode()
g1.set_velocity(linear_x=1.0)  # 1 m/s
```

Bom para: NavegaÃ§Ã£o contÃ­nua, seguir pessoas

</TabItem>

<TabItem value="position" label="Position Control">

**Controle por posiÃ§Ã£o** (preciso):

```python
# VocÃª especifica destino exato
g1.set_position_mode()
g1.move_to_position(x=2.0, y=0.0, tolerance=0.05)
```

Bom para: Alinhamento preciso, pegar objetos

</TabItem>

<TabItem value="trajectory" label="Trajectory Control">

**Controle por trajetÃ³ria** (complexo):

```python
# Especificar caminho completo
trajectory = [
    (0.0, 0.0, 0.0),
    (1.0, 0.5, 0.2),
    (2.0, 1.0, 0.5),
]

g1.set_trajectory_mode()
g1.execute_trajectory(trajectory, duration=10.0)
```

Bom para: Movimentos coreografados, danÃ§a

</TabItem>
</Tabs>

---

## ğŸ“Š Monitoramento de Desempenho

### MÃ©tricas Importantes

```python
# Verificar saÃºde da locomoÃ§Ã£o
metrics = g1.get_locomotion_metrics()

print(f"Velocidade atual: {metrics['velocity_x']:.2f} m/s")
print(f"InclinaÃ§Ã£o (pitch): {metrics['pitch']:.2f}Â°")
print(f"Temperatura motores: {metrics['motor_temp_avg']:.1f}Â°C")
print(f"Energia gasta: {metrics['energy_consumed']:.1f} Wh")

# âš ï¸ Alertas
if metrics['motor_temp_avg'] > 65:
    print("âš ï¸ MOTORES QUENTES! Reduzir velocidade.")
    g1.set_velocity(0.3)

if metrics['pitch'] > 15:
    print("âš ï¸ INCLINADO DEMAIS! Risco de queda.")
    g1.emergency_stop()
```

---

## âœ… Checklist de PrÃ¡tica

- [ ] Testou todos os 4 modos de caminhada (walk, trot, climb, balance)
- [ ] Criou mapa completo de um ambiente (casa/escritÃ³rio)
- [ ] Fez G1 navegar autonomamente para 3 locais diferentes
- [ ] Testou desvio de obstÃ¡culos (colocar cadeira no caminho)
- [ ] Configurou zonas de seguranÃ§a personalizadas
- [ ] Fez G1 subir/descer escadas com sucesso
- [ ] Monitorou mÃ©tricas de desempenho durante operaÃ§Ã£o

---

## ğŸ› Troubleshooting Comum

| Problema | Causa | SoluÃ§Ã£o |
|----------|-------|---------|
| G1 nÃ£o sai do lugar | Modo errado | Verificar `get_gait_mode()`, setar para "walk" |
| Caminha torto | IMU descalibrada | `g1.calibrate_imu()` (robÃ´ parado) |
| Para frequentemente | Sensores sujos | Limpar LIDAR e cÃ¢meras com pano microfibra |
| NÃ£o sobe escadas | Degrau muito alto | MÃ¡ximo 18cm, verificar com `nav.measure_step_height()` |
| Navega devagar | Costmap muito conservador | Reduzir `costmap_inflation` de 0.5 para 0.3 |

---

## ğŸ”— PrÃ³ximos Passos

:::tip PrÃ³ximo MÃ³dulo
**[ğŸ¦¾ ManipulaÃ§Ã£o com BraÃ§os â†’](./manipulacao-bracos)**

Aprenda a usar os braÃ§os e garras do G1 para interagir com objetos.
:::

---

**â±ï¸ Tempo:** 45-60 min | **ğŸ® Hands-on:** Essencial | **ğŸ“ EspaÃ§o:** 3m x 3m mÃ­nimo
