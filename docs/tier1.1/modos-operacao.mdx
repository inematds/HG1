---
sidebar_position: 6
title: 6. Modos de OperaÃ§Ã£o
description: Damping, Preparation, Movement - estados do G1
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# âš™ï¸ Modos de OperaÃ§Ã£o

:::tip Objetivo
Compreender os trÃªs modos operacionais do G1 e transiÃ§Ãµes entre eles: Damping, Preparation e Movement.
:::

---

## ğŸ“Š Estados do Sistema

### Diagrama de Estados

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        Power ON â†’  â”‚   BOOT (20s)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  0: DAMPING    â”‚ â† Modo seguro
                    â”‚  (Zero torque)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†•  â”‚ L1+UP
        Manual move      â”‚  â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ 1: PREPARATION â”‚ â† Pronto para operar
                    â”‚   (Standing)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†•  â”‚ START
      AUTO/Commands      â”‚  â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  2: MOVEMENT   â”‚ â† OperaÃ§Ã£o ativa
                    â”‚   (Walking)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                L2+R2 â†’     â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ EMERGENCY STOP â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“ (sit down)
                      [DAMPING]
```

---

## ğŸ”µ Mode 0: DAMPING (Safe Mode)

### CaracterÃ­sticas

**Quando o G1 Entra neste Modo:**
- âœ… Ao ligar (boot completo)
- âœ… ApÃ³s emergency stop
- âœ… Bateria &lt;5%
- âœ… Erro crÃ­tico detectado
- âœ… BotÃ£o DAMPING pressionado

**Comportamento:**
```
Motors: Zero torque (gravity compensation OFF)
â”œâ”€ VocÃª pode mover membros manualmente
â”œâ”€ RobÃ´ NÃƒO se sustenta sozinho
â””â”€ Cai se nÃ£o apoiado

Sensores: Ativos (LIDAR, cÃ¢meras, IMU)
â”œâ”€ ROS2 nodes rodando
â””â”€ Pode ler telemetria

Computador: Jetson ligado
â””â”€ SSH/API acessÃ­veis
```

---

### Uso PrÃ¡tico

<Tabs>
<TabItem value="manual" label="MovimentaÃ§Ã£o Manual">

**Quando Usar:**
- Posicionar robÃ´ manualmente
- CalibraÃ§Ã£o de poses
- Ensino por demonstraÃ§Ã£o (kinesthetic teaching)
- ManutenÃ§Ã£o segura

**Exemplo:**
```python
from unitree_sdk import Robot

robot = Robot()

# Entrar em modo damping
robot.set_mode(0)  # DAMPING

print("VocÃª pode mover os braÃ§os manualmente agora")
print("Gravando trajetÃ³ria...")

trajectory = []
for i in range(100):  # 10 segundos @ 10Hz
    # Ler posiÃ§Ãµes atuais das juntas
    joint_positions = robot.get_joint_positions()
    trajectory.append(joint_positions)
    time.sleep(0.1)

print("TrajetÃ³ria gravada com", len(trajectory), "pontos")
# Pode reproduzir depois em modo Movement
```

</TabItem>

<TabItem value="transport" label="Transporte">

**Preparar G1 para transporte:**

```bash
# 1. Modo damping
robot.set_mode(0)

# 2. Sentar posiÃ§Ã£o compacta
# (manualmente posicione):
# - Pernas dobradas sob corpo
# - BraÃ§os junto ao torso
# - CabeÃ§a centralizada

# 3. Desligar
robot.shutdown()

# 4. Remover bateria
# 5. Embalar em case
```

**PosiÃ§Ã£o Recomendada para Transporte:**
```
     O  â† CabeÃ§a baixa
    /â”‚\
    / \  â† Pernas dobradas
  Altura total: ~70cm (vs 132cm em pÃ©)
```

</TabItem>

<TabItem value="safety" label="SeguranÃ§a">

**Damping mode Ã© o modo MAIS SEGURO:**

âœ… **Quando usar Damping:**
- Primeira vez ligando o robÃ´
- PresenÃ§a de crianÃ§as/pets prÃ³ximos
- Desenvolvimento de novo software (teste iniciais)
- Qualquer situaÃ§Ã£o incerta

âŒ **NÃƒO usar Damping quando:**
- RobÃ´ precisa se sustentar em pÃ©
- Durante navegaÃ§Ã£o autÃ´noma
- (Use Preparation ou Movement)

**Emergency â†’ Damping:**
```python
# Em qualquer cÃ³digo, sempre ter:
try:
    robot.walk(speed=1.0)
except Exception as e:
    print(f"Erro: {e}")
    robot.emergency_stop()  # â†’ Mode 0
    robot.sit_down()
```

</TabItem>
</Tabs>

---

## ğŸŸ¡ Mode 1: PREPARATION (Ready)

### CaracterÃ­sticas

**Estado:**
```
Motors: Torque ativo, holding position
â”œâ”€ RobÃ´ sustenta prÃ³prio peso
â”œâ”€ Pode ficar em pÃ© indefinidamente
â””â”€ Consome ~80W

PosiÃ§Ã£o: Standing (padrÃ£o)
â”œâ”€ Pernas estendidas
â”œâ”€ Torso vertical
â””â”€ BraÃ§os relaxados ao lado

Pronto para: Receber comandos
â”œâ”€ Executar poses
â”œâ”€ Mover braÃ§os
â””â”€ Iniciar caminhada (â†’ Movement)
```

---

### TransiÃ§Ã£o Damping â†’ Preparation

<Tabs>
<TabItem value="manual-transition" label="Manualmente (RC)">

**Usando Controle:**

```
SequÃªncia:
1. L1 + UP (press simultÃ¢neo)
   â””â”€ G1 inicia stand up sequence

2. Aguardar 3-5 segundos
   â””â”€ Pernas estendem gradualmente

3. LED status muda: Azul â†’ Verde
   â””â”€ Modo Preparation ativo

4. Pronto para operar!
```

**AnimaÃ§Ã£o de Stand-Up:**
```
Frame 1 (0s):   Sentado
     _O_
    / | \     Damping mode
    â€¾ â€¾ â€¾

Frame 2 (1.5s): Apoiando mÃ£os
     _O_
    /|||\ â†   MÃ£os no chÃ£o
    / | \

Frame 3 (3s):   Levantando
     _O_
    / | \  â†  Pernas estendendo
    /   \

Frame 4 (5s):   Em pÃ©
      O
     /|\   â†  Preparation mode
     / \
```

</TabItem>

<TabItem value="api-transition" label="Via API">

**Python SDK:**

```python
from unitree_sdk import Robot
import time

robot = Robot()

# Verificar modo atual
current_mode = robot.get_mode()
print(f"Modo atual: {current_mode}")  # 0 = Damping

# Stand up
if current_mode == 0:
    print("Iniciando stand up...")
    robot.stand_up()  # MÃ©todo high-level

    # Aguardar transiÃ§Ã£o
    while robot.get_mode() != 1:
        print("Aguardando... ", robot.get_mode())
        time.sleep(0.5)

    print("âœ… RobÃ´ em pÃ© (Preparation mode)")

# Verificar se estÃ¡vel
if robot.is_balanced():
    print("âœ… EquilÃ­brio estÃ¡vel")
else:
    print("âš ï¸ InstÃ¡vel, verificar chÃ£o plano")
```

</TabItem>

<TabItem value="conditions" label="PrÃ©-CondiÃ§Ãµes">

**Para stand-up ter sucesso, verificar:**

1. **ChÃ£o Plano**
   ```python
   imu = robot.get_imu()
   tilt = abs(imu.pitch) + abs(imu.roll)

   if tilt > 5:  # Mais de 5Â° inclinaÃ§Ã£o
       print("âš ï¸ ChÃ£o muito inclinado!")
       # NÃ£o tentar stand-up
   ```

2. **Bateria Suficiente**
   ```python
   if robot.battery.soc < 10:
       print("âŒ Bateria muito baixa para stand-up")
       # Requer ~2% de bateria para stand-up
   ```

3. **EspaÃ§o Livre**
   - Nada bloqueando pernas
   - 1m de espaÃ§o ao redor mÃ­nimo
   - Sem pessoas/objetos prÃ³ximos

4. **Sem Erros**
   ```python
   errors = robot.get_errors()
   if errors:
       print(f"âŒ Erros detectados: {errors}")
       print("Resolver antes de stand-up")
   ```

</TabItem>
</Tabs>

---

### OperaÃ§Ãµes em Preparation Mode

**O que vocÃª pode fazer:**

```python
# 1. Executar poses prÃ©-programadas
robot.pose('wave')         # Acenar
robot.pose('point_front')  # Apontar para frente
robot.pose('arms_up')      # BraÃ§os para cima

# 2. Controle de braÃ§os
robot.arm_left.move_to_xyz(x=0.3, y=0.2, z=1.0)

# 3. Virar cabeÃ§a
robot.head.pan(angle=45)   # Olhar 45Â° direita
robot.head.tilt(angle=-20) # Olhar 20Â° para baixo

# 4. Pequenos ajustes de posiÃ§Ã£o (sem caminhar)
robot.lean_forward(angle=5)   # Inclinar 5Â° frente
robot.shift_weight_left()     # Peso perna esquerda

# 5. Preparar para movimento
robot.prepare_walk()  # PrÃ©-calcula gait
robot.set_mode(2)     # â†’ Movement mode
```

---

## ğŸŸ¢ Mode 2: MOVEMENT (Active)

### CaracterÃ­sticas

**Estado:**
```
Motors: Controle dinÃ¢mico ativo
â”œâ”€ Caminhada, corrida, saltos
â”œâ”€ EstabilizaÃ§Ã£o ativa (100Hz)
â””â”€ Consome 150-500W (depende velocidade)

Controladores: Todos ativos
â”œâ”€ Locomotion controller (pernas)
â”œâ”€ Balance controller (IMU feedback)
â”œâ”€ Arm controllers (braÃ§os independentes)
â””â”€ Navigation (se autÃ´nomo)

Sensores: Loop fechado
â”œâ”€ LIDAR â†’ obstacle avoidance
â”œâ”€ Cameras â†’ vision-based control
â”œâ”€ IMU â†’ dynamic balance
â””â”€ Foot sensors â†’ terrain adaptation
```

---

### TransiÃ§Ã£o Preparation â†’ Movement

<Tabs>
<TabItem value="manual-walk" label="Caminhada Manual">

**Via Controle RC:**

```
1. Certifique-se que estÃ¡ em Preparation (verde)

2. Mover LEFT STICK:
   â”œâ”€ UP/DOWN: Frente/trÃ¡s
   â”œâ”€ LEFT/RIGHT: Girar
   â””â”€ Magnitude: Velocidade

3. G1 transiciona automaticamente para Movement
   â””â”€ LED: Verde â†’ Verde piscando

4. Soltar stick: Para e volta para Preparation
```

**Via CÃ³digo:**
```python
# MÃ©todo 1: Velocity command (manual)
robot.set_velocity(linear_x=0.5, angular_z=0.0)
# G1 entra em Movement mode automaticamente

# MÃ©todo 2: Explicit mode change
robot.set_mode(2)  # Movement
robot.walk_forward(speed=0.8)

# Para
robot.stop()  # Volta para Preparation
```

</TabItem>

<TabItem value="auto-nav" label="NavegaÃ§Ã£o AutÃ´noma">

**Com Nav2 (ROS2):**

```python
# navigation_example.py
import rclpy
from nav2_simple_commander.robot_navigator import BasicNavigator
from geometry_msgs.msg import PoseStamped

def navigate_to_goal(x, y, theta):
    navigator = BasicNavigator()

    # Definir goal
    goal_pose = PoseStamped()
    goal_pose.header.frame_id = 'map'
    goal_pose.pose.position.x = x
    goal_pose.pose.position.y = y
    goal_pose.pose.orientation.z = theta

    # G1 entra em Movement mode aqui
    navigator.goToPose(goal_pose)

    # Aguardar conclusÃ£o
    while not navigator.isTaskComplete():
        feedback = navigator.getFeedback()
        print(f"DistÃ¢ncia restante: {feedback.distance_remaining:.2f}m")

    print("âœ… Goal alcanÃ§ado!")
    # G1 volta para Preparation

# Uso:
navigate_to_goal(x=5.0, y=2.0, theta=0.0)  # 5m frente, 2m esquerda
```

</TabItem>

<TabItem value="complex" label="Movimentos Complexos">

**Caminhar + Manipular Simultaneamente:**

```python
# walk_and_grab.py
from concurrent.futures import ThreadPoolExecutor

def walk_task():
    """Thread 1: Caminhar"""
    robot.walk_to_position(x=2.0, y=0.0)

def arm_task():
    """Thread 2: Mover braÃ§o durante caminhada"""
    time.sleep(1)  # Esperar comeÃ§ar andar

    # Pegar objeto Ã  direita enquanto anda
    robot.arm_right.move_to_xyz(x=0.4, y=-0.3, z=0.8)
    robot.hand_right.close()

    time.sleep(2)  # Segurar

    robot.hand_right.open()  # Soltar

with ThreadPoolExecutor(max_workers=2) as executor:
    f1 = executor.submit(walk_task)
    f2 = executor.submit(arm_task)

    f1.result()  # Aguardar ambos
    f2.result()

print("âœ… Tarefa completa!")
```

**Corrida:**
```python
# Requer modo Movement
robot.set_mode(2)

# Velocidade mÃ¡xima: 2 m/s (caminhada)
robot.walk_forward(speed=2.0)

# Para sprint (>2 m/s), usar gait especÃ­fico
robot.set_gait('run')  # Muda para gait de corrida
robot.run(speed=3.0)   # AtÃ© 3 m/s

# âš ï¸ Corrida consome 600W+ (bateria dura ~1h)
```

</TabItem>
</Tabs>

---

### LimitaÃ§Ãµes em Movement Mode

**RestriÃ§Ãµes de SeguranÃ§a:**

```python
# Velocidade mÃ¡xima por gait
LIMITS = {
    'walk':   2.0,  # m/s
    'run':    3.0,  # m/s
    'trot':   1.5,  # m/s (mais estÃ¡vel)
}

# AceleraÃ§Ã£o mÃ¡xima
MAX_ACCEL = 1.0  # m/sÂ²

# InclinaÃ§Ã£o mÃ¡xima do terreno
MAX_SLOPE = 15  # graus

# Altura de degrau
MAX_STEP_HEIGHT = 0.20  # metros

# VerificaÃ§Ã£o antes de comando
def safe_walk(speed):
    if speed > LIMITS['walk']:
        print(f"âš ï¸ Velocidade limitada a {LIMITS['walk']} m/s")
        speed = LIMITS['walk']

    if robot.get_slope() > MAX_SLOPE:
        print("âŒ Terreno muito inclinado!")
        return False

    robot.walk_forward(speed)
    return True
```

---

## ğŸ”´ Emergency Stop

### AtivaÃ§Ã£o

**Causas de E-Stop:**

1. **Manual** (L2+R2 no controle)
2. **Queda detectada** (IMU)
   ```python
   if abs(imu.pitch) > 45 or abs(imu.roll) > 45:
       emergency_stop()
   ```
3. **ColisÃ£o** (forÃ§a sÃºbita nos pÃ©s/braÃ§os)
4. **Bateria crÃ­tica** (&lt;3%)
5. **Motor superaquecido** (&gt;90Â°C)
6. **Perda de comunicaÃ§Ã£o** (timeout 2s)

---

### Comportamento

```
Emergency Stop Sequence:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1. [0ms] Parar todos comandos de movimento
2. [10ms] Ativar controle de estabilizaÃ§Ã£o MAX
3. [50ms] Tentar sit down controlado
4. [2000ms] Se nÃ£o conseguiu sentar â†’ Damping mode
5. [2100ms] Enviar log de erro

LED: Vermelho piscando rÃ¡pido
Som: Beep contÃ­nuo (se alto-falante habilitado)
```

**Recovery:**
```python
# ApÃ³s emergency stop
if robot.get_mode() == 0:  # Damping
    print("Robot em emergency stop")

    # 1. Verificar causa
    errors = robot.get_errors()
    print(f"Erros: {errors}")

    # 2. Resolver problema (ex: bateria)

    # 3. Clear errors
    robot.clear_errors()

    # 4. Stand up novamente
    robot.stand_up()  # â†’ Preparation mode
```

---

## ğŸ“Š Monitoramento de Estado

### Dashboard em Tempo Real

```python
# monitor.py
import time
import os

def monitor_robot_state():
    while True:
        os.system('clear')

        mode = robot.get_mode()
        mode_names = ['DAMPING', 'PREPARATION', 'MOVEMENT', 'ERROR']

        print("â•" * 50)
        print(f"  UNITREE G1 STATUS MONITOR")
        print("â•" * 50)
        print(f"Mode:    [{mode}] {mode_names[mode]}")
        print(f"Battery:  {robot.battery.soc}% ({robot.battery.voltage:.1f}V)")
        print(f"Speed:    {robot.get_speed():.2f} m/s")
        print(f"Position: ({robot.x:.2f}, {robot.y:.2f})")
        print(f"IMU:      Pitch={robot.imu.pitch:.1f}Â° Roll={robot.imu.roll:.1f}Â°")
        print("â•" * 50)

        # Estado dos motores (resumido)
        temps = robot.get_motor_temperatures()
        max_temp = max(temps.values())
        avg_temp = sum(temps.values()) / len(temps)

        print(f"Motors:   Avg={avg_temp:.0f}Â°C Max={max_temp:.0f}Â°C")

        # Warnings
        if mode == 0 and robot.is_moving():
            print("âš ï¸  WARNING: Moving in DAMPING mode!")

        if max_temp > 80:
            print("âš ï¸  WARNING: Motor overheating!")

        if robot.battery.soc < 20:
            print("âš ï¸  WARNING: Low battery!")

        time.sleep(0.5)  # Update 2Hz

# Rodar
monitor_robot_state()
```

---

## âœ… Checklist de Conhecimento

ApÃ³s este mÃ³dulo, vocÃª deve saber:

- [ ] 3 modos: Damping (0), Preparation (1), Movement (2)
- [ ] Damping = zero torque, movimentaÃ§Ã£o manual segura
- [ ] Preparation = em pÃ©, pronto para comandos
- [ ] Movement = caminhada/navegaÃ§Ã£o ativa
- [ ] Emergency stop â†’ sempre retorna para Damping
- [ ] TransiÃ§Ãµes: L1+UP (stand up), START (walk), L2+R2 (e-stop)

---

## ğŸ”— PrÃ³ximos Passos

:::tip PrÃ³ximo MÃ³dulo
**[ğŸ¯ EspecificaÃ§Ãµes vs Concorrentes â†’](./specs-comparacao)**

G1 vs Tesla Optimus, Figure 01, Atlas - comparaÃ§Ã£o tÃ©cnica completa.
:::

---

**â±ï¸ Tempo de estudo:** 40-50 minutos
**ğŸ“Š NÃ­vel:** IntermediÃ¡rio
**ğŸ® Hands-on:** Testar transiÃ§Ãµes de modos com RC ou API
